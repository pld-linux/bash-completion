# PLD Linux builder(1) script completion

_builder()
{
	local cur prev words cword
	_init_completion || return

	case $prev in
	-r)
		local spec=*.spec
		COMPREPLY=( $( compgen -W '$( git tag )' -- "$cur" ) )
		return 0
		;;
	--with|--without)
		local spec=*.spec
		$1 -nn -ncs --show-avail-bconds $spec
		return 0
		;;
	esac

	if [[ $cur == -* ]]; then
		COMPREPLY=( $( compgen -W '$( _parse_help "$1" )' -- "$cur" ) )
	else
		_filedir spec
	fi
} &&
complete -F _builder builder
